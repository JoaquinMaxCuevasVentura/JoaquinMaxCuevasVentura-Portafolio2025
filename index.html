<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta id="meta-description" name="description" content="Portafolio profesional de Joaquín Max Cuevas Ventura - Arquitectura y Diseño Gráfico" />
  <title id="doc-title">PORTAFOLIO 2026 | Joaquin Max Cuevas Ventura</title>

  <!-- Tailwind (requerido) -->
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>

  <!-- Fuente -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Archivo:wght@300;400;600;700;800&display=swap" rel="stylesheet" />

  <!-- dFlip -->
  <link href="https://cdn.jsdelivr.net/npm/dflip/css/dflip.min.css" rel="stylesheet" type="text/css" />
  <link href="https://cdn.jsdelivr.net/npm/dflip/css/themify-icons.min.css" rel="stylesheet" type="text/css" />

  <style>
    :root {
      --bg-color: #222223;
      --accent-color: #dc6b2f;
      --text-main: #ffffff;
      --ui-opacity: 0.7;
      --icon-size-desktop: 16px;
      --icon-size-tablet: 15px;
      --icon-size-mobile: 14px;
      --icon-size-small: 13px;
    }

    *,
    *::before,
    *::after {
      box-sizing: border-box;
    }

    body,
    html {
      height: 100%;
      margin: 0;
      background-color: var(--bg-color);
      font-family: 'Archivo', sans-serif;
      overflow: hidden;
    }

    /* Capa de Ruido */
    #grained-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 0;
      pointer-events: none;
    }

    /* Capa del Libro */
    #flipbook-container {
      height: 100vh;
      width: 100vw;
      position: relative;
      z-index: 10;
      overflow: hidden;
    }

    /* Asegurar que el contenedor de dFlip no cause overflow */
    .df-container {
      max-width: 100vw !important;
      overflow-x: hidden !important;
    }

    /* --- INTERFAZ MINIMALISTA --- */
    .df-ui-wrapper {
      background: transparent !important;
      box-shadow: none !important;
      border: none !important;
      padding: 10px 8px 30px 8px !important;
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
      flex-wrap: nowrap !important;
      gap: 0 !important;
      max-width: 100vw !important;
      overflow-x: auto !important;
      overflow-y: visible !important;
      -webkit-overflow-scrolling: touch !important;
      scrollbar-width: none !important;
      -ms-overflow-style: none !important;
      min-height: 50px !important;
    }

    .df-ui-wrapper::-webkit-scrollbar {
      display: none !important;
    }

    .df-ui-btn {
      background: transparent !important;
      border: none !important;
      box-shadow: none !important;
      color: var(--text-main) !important;
      border-radius: 0 !important;
      margin: 0 8px !important;
      padding: 8px 4px !important;
      transition: color 0.2s ease, opacity 0.2s ease, transform 0.2s ease;
      opacity: var(--ui-opacity);
      width: auto !important;
      height: auto !important;
      min-height: 32px !important;
      display: inline-flex !important;
      align-items: center !important;
      justify-content: center !important;
      font-size: 13px !important;
      flex-shrink: 0 !important;
      line-height: 1.2 !important;
    }

    /* === ICONOS UNIFORMES Y RESPONSIVOS === */
    .df-ui-btn i,
    .df-ui-btn .ti,
    .df-ui-btn [class^="ti-"],
    .df-ui-btn [class*=" ti-"] {
      font-size: var(--icon-size-desktop) !important;
      line-height: 1 !important;
      display: inline-flex !important;
      align-items: center !important;
      justify-content: center !important;
      width: auto !important;
      height: auto !important;
    }

    .df-ui-btn:hover,
    .df-ui-btn.active,
    .df-ui-btn.info-active,
    .df-ui-btn.lang-active {
      color: var(--accent-color) !important;
      background: transparent !important;
      opacity: 1 !important;
      transform: scale(1.3);
      text-shadow: 0 0 10px rgba(220, 107, 47, 0.5);
    }

    .df-ui-btn:focus {
      outline: none;
    }

    .df-ui-btn:focus-visible {
      color: var(--accent-color) !important;
      opacity: 1 !important;
      transform: scale(1.3);
      text-shadow: 0 0 10px rgba(220, 107, 47, 0.5);
      outline: 2px solid var(--accent-color);
      outline-offset: 4px;
    }

    .df-ui-page {
      width: auto !important;
      min-width: 0 !important;
      margin: 0 !important;
      background: transparent !important;
      box-shadow: none !important;
      border: none !important;
    }

    .df-ui-page input {
      width: 40px !important;
      text-align: center !important;
      background: transparent !important;
      border: none !important;
      color: var(--text-main) !important;
      font-family: 'Archivo', sans-serif !important;
      font-size: 12px !important;
      padding: 0 !important;
      height: 30px !important;
      box-shadow: none !important;
    }

    .df-ui-btn.df-ui-prev,
    .df-ui-btn.df-ui-next {
      margin: 0 2px !important;
    }

    /* Idiomas (grupo) */
    .df-ui-langgroup {
      display: inline-flex;
      align-items: center;
      gap: 0;
      margin-left: 6px;
    }

    .df-ui-langsep {
      color: rgba(255, 255, 255, 0.35);
      opacity: 1;
      font-size: 12px;
      user-select: none;
      margin: 0 2px;
      transform: none;
      text-shadow: none;
    }

    .df-ui-langbtn {
      font-size: 12px;
      letter-spacing: 2px;
      font-weight: 600;
      padding: 0;
      line-height: 1;
      text-transform: uppercase;
    }

    /* --- GESTIÓN DE HIPERVÍNCULOS --- */
    .df-page-content .df-link,
    .df-page-content a {
      opacity: 0 !important;
      background: transparent !important;
      cursor: pointer !important;
    }

    /* --- VENTANA MODAL INFO --- */
    .modal-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.96);
      z-index: 9999;
      justify-content: center;
      align-items: center;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .modal-overlay.show {
      display: flex;
      opacity: 1;
    }

    .modal-content {
      color: #fff;
      max-width: 500px;
      width: 85%;
      text-align: center;
      position: relative;
      max-height: 90vh;
      overflow-y: auto;
      padding: 20px;
    }

    .modal-line {
      width: 40px;
      height: 2px;
      background-color: var(--accent-color);
      margin: 20px auto;
    }

    .modal-title {
      font-size: 20px;
      font-weight: 800;
      margin-bottom: 5px;
      text-transform: uppercase;
      letter-spacing: 2px;
      line-height: 1.2;
    }

    .modal-subtitle {
      font-size: 11px;
      color: var(--accent-color);
      margin-bottom: 30px;
      text-transform: uppercase;
      letter-spacing: 2px;
      font-weight: 600;
    }

    .modal-body {
      font-size: 14px;
      color: #ccc;
      line-height: 1.6;
      font-weight: 300;
    }

    /* --- SECCIÓN CONTACTO MODIFICADA --- */
    .modal-contact {
      margin-top: 30px;
      border-top: 1px solid #222;
      padding-top: 25px;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .contact-link {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-decoration: none;
      background: transparent;
      border: none;
      cursor: pointer;
      width: 100%;
      padding: 5px 0;
      transition: opacity 0.2s ease;
    }

    /* Etiqueta: Pequeña, gris y mayúsculas (CORREO / TELEFONO) */
    .contact-label {
      display: block;
      color: #666;
      font-size: 10px;
      letter-spacing: 2px;
      text-transform: uppercase;
      margin-bottom: 6px;
      font-weight: 600;
      transition: color 0.2s ease;
    }

    /* Valor: Blanco y tamaño normal (El correo o número real) */
    .contact-value {
      display: block;
      color: #ffffff;
      font-size: 14px;
      letter-spacing: 0.5px;
      font-weight: 400;
      transition: color 0.2s ease;
      word-break: break-word;
    }

    /* --- HOVER SOLO EN EL VALOR --- */
    .contact-link:hover .contact-value,
    .contact-link:focus .contact-value {
      color: var(--accent-color);
    }
    
    .contact-link:hover .contact-label,
    .contact-link:focus .contact-label {
      color: #666; 
    }

    .contact-link:focus-visible {
      outline: 2px solid var(--accent-color);
      outline-offset: 4px;
      border-radius: 4px;
    }

    .contact-link[aria-disabled='true'] {
      cursor: default;
      pointer-events: none;
    }

    .close-modal {
      position: absolute;
      top: -50px;
      right: 0;
      color: #666;
      font-size: 30px;
      cursor: pointer;
      transition: color 0.2s ease;
      font-weight: 100;
      background: transparent;
      border: none;
      padding: 10px;
      line-height: 1;
    }

    .close-modal:hover,
    .close-modal:focus {
      color: var(--accent-color);
      outline: none;
    }

    .close-modal:focus-visible {
      outline: 2px solid var(--accent-color);
      outline-offset: 2px;
    }

    /* --- PANTALLA DE ERROR PDF --- */
    .pdf-error-message {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: #666;
      text-align: center;
      font-size: 14px;
      letter-spacing: 1px;
      z-index: 5;
      display: none;
      padding: 0 16px;
    }

    .pdf-error-message.show {
      display: block;
    }

    /* ============================================
       RESPONSIVE: ICONOS UNIFORMES
       ============================================ */

    /* Tablets y móviles grandes (≤640px) - 15px */
    @media screen and (max-width: 640px) {
      :root {
        --icon-size-current: var(--icon-size-tablet);
      }

      .df-ui-wrapper {
        padding: 8px 4px 25px 4px !important;
        min-height: 45px !important;
      }

      .df-ui-btn {
        margin: 0 4px !important;
        padding: 6px 3px !important;
        font-size: 11px !important;
        min-height: 28px !important;
      }

      .df-ui-btn i,
      .df-ui-btn .ti,
      .df-ui-btn [class^="ti-"],
      .df-ui-btn [class*=" ti-"] {
        font-size: var(--icon-size-tablet) !important;
      }

      .df-ui-page input {
        width: 36px !important;
        font-size: 11px !important;
      }

      .df-ui-langbtn {
        font-size: 10px !important;
        letter-spacing: 1.5px !important;
      }

      .df-ui-langgroup {
        margin-left: 3px !important;
      }

      .df-ui-langsep {
        margin: 0 1px !important;
      }
    }

    /* Móviles estrechos (≤380px) - 14px */
    @media screen and (max-width: 380px) {
      .df-ui-wrapper {
        padding: 6px 3px 20px 3px !important;
        min-height: 42px !important;
      }

      .df-ui-btn {
        margin: 0 3px !important;
        padding: 5px 2px !important;
        font-size: 10px !important;
        min-height: 26px !important;
      }

      .df-ui-btn i,
      .df-ui-btn .ti,
      .df-ui-btn [class^="ti-"],
      .df-ui-btn [class*=" ti-"] {
        font-size: var(--icon-size-mobile) !important;
      }

      .df-ui-page input {
        width: 32px !important;
        font-size: 10px !important;
      }

      .df-ui-langbtn {
        font-size: 9px !important;
        letter-spacing: 1px !important;
        margin: 0 1px !important;
      }

      .df-ui-langgroup {
        margin-left: 2px !important;
      }

      .df-ui-langsep {
        margin: 0 1px !important;
        font-size: 9px !important;
      }

      .modal-content {
        width: 92%;
        padding: 15px;
      }

      .modal-title {
        font-size: 16px;
        letter-spacing: 1px;
      }

      .modal-subtitle {
        font-size: 10px;
        margin-bottom: 20px;
      }

      .modal-body {
        font-size: 13px;
      }

      .contact-label {
        font-size: 9px;
        letter-spacing: 1.5px;
      }

      .contact-value {
        font-size: 12px;
      }

      .close-modal {
        top: -40px;
        right: -5px;
        font-size: 26px;
      }

      .modal-contact {
        gap: 14px;
        padding-top: 20px;
      }
    }

    /* Móviles muy pequeños (≤320px) - 13px */
    @media screen and (max-width: 320px) {
      .df-ui-wrapper {
        padding: 5px 2px 18px 2px !important;
        min-height: 40px !important;
      }

      .df-ui-btn {
        margin: 0 2px !important;
        padding: 4px 2px !important;
        font-size: 9px !important;
        min-height: 24px !important;
      }

      .df-ui-btn i,
      .df-ui-btn .ti,
      .df-ui-btn [class^="ti-"],
      .df-ui-btn [class*=" ti-"] {
        font-size: var(--icon-size-small) !important;
      }

      .df-ui-page input {
        width: 28px !important;
        font-size: 9px !important;
      }

      .df-ui-langbtn {
        font-size: 8px !important;
        letter-spacing: 0.5px !important;
      }

      .df-ui-langsep {
        font-size: 8px !important;
        margin: 0 !important;
      }

      .modal-content {
        width: 95%;
        padding: 12px;
      }

      .modal-title {
        font-size: 14px;
      }

      .contact-value {
        font-size: 11px;
      }
    }

    /* Responsive: pantallas cortas */
    @media screen and (max-height: 500px) {
      .modal-content {
        max-height: 85vh;
        padding-top: 10px;
        padding-bottom: 10px;
      }

      .modal-subtitle {
        margin-bottom: 15px;
      }

      .close-modal {
        top: -35px;
      }
    }

    /* --- MODO PANTALLA COMPLETA --- */
    /* Fondo para el contenedor de dFlip en fullscreen */
    .df-container.df-fullscreen,
    .df-container.df-fullscreen .df-book-wrapper,
    #flipbook-container.df-fullscreen {
      background-color: var(--bg-color) !important;
    }

    /* Selector nativo de fullscreen del navegador */
    #flipbook-container:fullscreen,
    #flipbook-container:-webkit-full-screen,
    #flipbook-container:-moz-full-screen,
    #flipbook-container:-ms-fullscreen {
      background-color: var(--bg-color) !important;
    }

    /* Para el wrapper interno de dFlip */
    .df-container:fullscreen,
    .df-container:-webkit-full-screen,
    .df-container:-moz-full-screen,
    .df-container:-ms-fullscreen {
      background-color: var(--bg-color) !important;
    }

    /* Skip link */
    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }

    .sr-only:focus {
      position: fixed;
      top: 10px;
      left: 10px;
      width: auto;
      height: auto;
      padding: 10px 20px;
      margin: 0;
      overflow: visible;
      clip: auto;
      white-space: normal;
      background: var(--accent-color);
      color: #fff;
      z-index: 99999;
      font-size: 14px;
    }
  </style>
</head>

<body>
  <a id="skip-link" href="#flipbook-container" class="sr-only">Saltar al portafolio</a>

  <div id="grained-container" aria-hidden="true"></div>

  <div id="pdf-error" class="pdf-error-message" role="alert" aria-live="polite">
    <p id="pdf-error-line1">No se pudo cargar el documento.</p>
    <p id="pdf-error-line2">Por favor, recarga la página.</p>
  </div>

  <div
    id="infoModal"
    class="modal-overlay"
    role="dialog"
    aria-modal="true"
    aria-labelledby="modal-title"
    aria-describedby="modal-description"
  >
    <div class="modal-content">
      <button
        type="button"
        class="close-modal"
        id="close-modal-btn"
        aria-label="Cerrar ventana de información"
      >
        &times;
      </button>

      <h1 id="modal-title" class="modal-title">JOAQUIN MAX<br />CUEVAS VENTURA</h1>
      <p id="modal-subtitle" class="modal-subtitle">PORTAFOLIO 2026</p>

      <div class="modal-line" aria-hidden="true"></div>

      <div id="modal-description" class="modal-body">
        <p id="modal-tagline">Arquitectura y diseño gráfico</p>

        <div class="modal-contact" role="group" aria-label="Información de contacto">
          <!-- CORREO -->
          <a
            id="email-link"
            href="mailto:JoACKo333@gmail.com"
            class="contact-link"
            aria-label="Enviar correo electrónico"
          >
            <span id="email-label" class="contact-label">CORREO</span>
            <span id="email-value" class="contact-value">JoACKo333@gmail.com</span>
          </a>

          <!-- TELÉFONO -->
          <button
            type="button"
            class="contact-link"
            id="phone-btn"
            aria-label="Copiar número de teléfono"
          >
            <span id="phone-label" class="contact-label">TELÉFONO / WHATSAPP</span>
            <span id="phone-display" class="contact-value">+591 78834651</span>
          </button>

          <!-- UBICACIÓN -->
          <div class="contact-link" aria-disabled="true" role="text">
            <span id="location-text" class="contact-label" style="margin-bottom:0; font-size:11px; letter-spacing:2px;">La Paz, Bolivia</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <main id="flipbook-container" role="main" aria-label="Visualizador de portafolio interactivo"></main>

  <!-- Scripts -->
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dflip/js/dflip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/grained/0.0.2/grained.min.js"></script>

  <script>
    (function () {
      'use strict';

      // --- CONFIG ---
      const PHONE_NUMBER = '+591 78834651';

      const PDF_ES = 'PORTAFOLIO_2026_JoaquinMaxCuevasVentura_v01_ES.pdf';
      const PDF_EN = 'PORTAFOLIO_2026_JoaquinMaxCuevasVentura_v01_EN.pdf';

      const COPY_FEEDBACK_DURATION = 2000;
      const STORAGE_KEY_LANG = 'portfolio_lang';

      // --- DOM ---
      const modal = document.getElementById('infoModal');
      const closeModalBtn = document.getElementById('close-modal-btn');
      const phoneBtn = document.getElementById('phone-btn');
      const phoneDisplay = document.getElementById('phone-display');
      const pdfErrorEl = document.getElementById('pdf-error');

      // i18n targets
      const htmlEl = document.documentElement;
      const metaDescriptionEl = document.getElementById('meta-description');
      const docTitleEl = document.getElementById('doc-title');
      const skipLinkEl = document.getElementById('skip-link');
      const modalSubtitleEl = document.getElementById('modal-subtitle');
      const modalTaglineEl = document.getElementById('modal-tagline');
      const emailLinkEl = document.getElementById('email-link');
      const phoneLabelEl = document.getElementById('phone-label');
      const locationTextEl = document.getElementById('location-text');
      const pdfErr1 = document.getElementById('pdf-error-line1');
      const pdfErr2 = document.getElementById('pdf-error-line2');

      // Estado
      let currentLang = 'es';
      let lastFocusedElement = null;

      // --- DICCIONARIO ACTUALIZADO ---
      const I18N = {
        es: {
          langAttr: 'es',
          title: 'PORTAFOLIO 2026 | Joaquin Max Cuevas Ventura',
          description: 'Portafolio profesional de Joaquín Max Cuevas Ventura - Arquitectura y Diseño Gráfico',
          skip: 'Saltar al portafolio',
          mainAria: 'Visualizador de portafolio interactivo',
          modalCloseAria: 'Cerrar ventana de información',
          modalSubtitle: 'PORTAFOLIO 2026',
          modalTagline: 'Arquitectura y diseño gráfico',
          
          // Sección Contacto
          emailAria: 'Enviar correo electrónico a JoACKo333@gmail.com',
          emailLabel: 'CORREO',
          phoneLabel: 'TELÉFONO / WHATSAPP',
          phoneAria: 'Copiar número de teléfono al portapapeles',
          locationText: 'LA PAZ, BOLIVIA',

          pdfError1: 'No se pudo cargar el documento.',
          pdfError2: 'Por favor, recarga la página.',
          clipboardOk: '¡NÚMERO COPIADO!',
          clipboardFail: '¡ERROR AL COPIAR!',
          infoBtnTitle: 'CONTACTO / INFO',
          infoBtnAria: 'Abrir información de contacto',
          langGroupAria: 'Idioma',
          langES: 'ES',
          langEN: 'EN',
          langESTitle: 'Ver portafolio en Español',
          langENTitle: 'View portfolio in English',
          dflipText: {
            toggleSound: 'SONIDO',
            toggleThumbnails: 'VISTA',
            toggleOutline: 'INDICE',
            previousPage: 'ANT',
            nextPage: 'SIG',
            toggleFullscreen: 'FULL',
            zoomIn: 'ZOOM +',
            zoomOut: 'ZOOM -'
          }
        },
        en: {
          langAttr: 'en',
          title: 'PORTFOLIO 2026 | Joaquin Max Cuevas Ventura',
          description: 'Professional portfolio of Joaquín Max Cuevas Ventura — Architecture & Graphic Design',
          skip: 'Skip to portfolio',
          mainAria: 'Interactive portfolio viewer',
          modalCloseAria: 'Close information dialog',
          modalSubtitle: 'PORTFOLIO 2026',
          modalTagline: 'Architecture & graphic design',
          
          // Contact Section
          emailAria: 'Send email to JoACKo333@gmail.com',
          emailLabel: 'EMAIL',
          phoneLabel: 'PHONE / WHATSAPP',
          phoneAria: 'Copy phone number to clipboard',
          locationText: 'LA PAZ, BOLIVIA',

          pdfError1: 'Could not load the document.',
          pdfError2: 'Please reload the page.',
          clipboardOk: 'NUMBER COPIED!',
          clipboardFail: 'COPY FAILED!',
          infoBtnTitle: 'CONTACT / INFO',
          infoBtnAria: 'Open contact information',
          langGroupAria: 'Language',
          langES: 'ES',
          langEN: 'EN',
          langESTitle: 'Ver portafolio en Español',
          langENTitle: 'View portfolio in English',
          dflipText: {
            toggleSound: 'SOUND',
            toggleThumbnails: 'VIEW',
            toggleOutline: 'OUTLINE',
            previousPage: 'PREV',
            nextPage: 'NEXT',
            toggleFullscreen: 'FULL',
            zoomIn: 'ZOOM +',
            zoomOut: 'ZOOM -'
          }
        }
      };

      function getLangFromUrl() {
        try {
          const url = new URL(window.location.href);
          const p = (url.searchParams.get('lang') || '').toLowerCase();
          if (p === 'es' || p === 'en') return p;
        } catch (_) {}
        return null;
      }

      function setLangInUrl(lang) {
        try {
          const url = new URL(window.location.href);
          url.searchParams.set('lang', lang);
          history.replaceState({}, '', url.toString());
        } catch (_) {}
      }

      function initGrained() {
        try {
          if (typeof grained === 'function') {
            grained('#grained-container', {
              animate: true,
              patternWidth: 100,
              patternHeight: 100,
              grainOpacity: 0.05,
              grainDensity: 1,
              grainWidth: 1,
              grainHeight: 1
            });
          }
        } catch (e) {
          console.warn('[Grained] No se pudo inicializar la textura de fondo:', e.message);
        }
      }

      function applyI18n(lang) {
        const t = I18N[lang] || I18N.es;

        htmlEl.setAttribute('lang', t.langAttr);
        document.title = t.title;
        if (docTitleEl) docTitleEl.textContent = t.title;
        if (metaDescriptionEl) metaDescriptionEl.setAttribute('content', t.description);
        if (skipLinkEl) skipLinkEl.textContent = t.skip;

        const mainEl = document.getElementById('flipbook-container');
        if (mainEl) mainEl.setAttribute('aria-label', t.mainAria);

        closeModalBtn.setAttribute('aria-label', t.modalCloseAria);
        if (modalSubtitleEl) modalSubtitleEl.textContent = t.modalSubtitle;
        if (modalTaglineEl) modalTaglineEl.textContent = t.modalTagline;

        // Actualización de Contacto
        if (emailLinkEl) emailLinkEl.setAttribute('aria-label', t.emailAria);
        
        // Actualizar el Label del correo (CORREO vs EMAIL)
        const emailLabelEl = document.getElementById('email-label');
        if (emailLabelEl) emailLabelEl.textContent = t.emailLabel;

        if (phoneLabelEl) phoneLabelEl.textContent = t.phoneLabel;
        phoneBtn.setAttribute('aria-label', t.phoneAria);
        if (locationTextEl) locationTextEl.textContent = t.locationText;

        if (pdfErr1) pdfErr1.textContent = t.pdfError1;
        if (pdfErr2) pdfErr2.textContent = t.pdfError2;

        // Actualizar si existe el botón info
        const infoBtn = document.getElementById('btn-info-custom');
        if (infoBtn) {
          infoBtn.setAttribute('title', t.infoBtnTitle);
          infoBtn.setAttribute('aria-label', t.infoBtnAria);
        }

        // Actualizar textos/aria del selector de idioma
        const langGroup = document.getElementById('df-ui-langgroup');
        if (langGroup) langGroup.setAttribute('aria-label', t.langGroupAria);

        const btnES = document.getElementById('btn-lang-es');
        const btnEN = document.getElementById('btn-lang-en');
        if (btnES) {
          btnES.textContent = t.langES;
          btnES.setAttribute('title', t.langESTitle);
          btnES.setAttribute('aria-label', t.langESTitle);
        }
        if (btnEN) {
          btnEN.textContent = t.langEN;
          btnEN.setAttribute('title', t.langENTitle);
          btnEN.setAttribute('aria-label', t.langENTitle);
        }
      }

      function getPdfForLang(lang) {
        return lang === 'en' ? PDF_EN : PDF_ES;
      }

      function hidePdfError() {
        if (pdfErrorEl) pdfErrorEl.classList.remove('show');
      }

      function showPdfError() {
        if (pdfErrorEl) pdfErrorEl.classList.add('show');
      }

      function copyPhone() {
        const originalText = phoneDisplay.textContent;
        const t = I18N[currentLang] || I18N.es;

        function showFeedback(success) {
          phoneDisplay.textContent = success ? t.clipboardOk : t.clipboardFail;
          phoneDisplay.style.color = success ? 'var(--accent-color)' : '#ff4444';
          phoneDisplay.style.fontWeight = '600';

          setTimeout(function () {
            phoneDisplay.textContent = originalText;
            phoneDisplay.style.color = '';
            phoneDisplay.style.fontWeight = '400';
          }, COPY_FEEDBACK_DURATION);
        }

        if (navigator.clipboard && navigator.clipboard.writeText) {
          navigator.clipboard
            .writeText(PHONE_NUMBER)
            .then(function () {
              showFeedback(true);
            })
            .catch(function (err) {
              console.warn('[Clipboard] Error con API moderna, intentando fallback:', err);
              fallbackCopy();
            });
        } else {
          fallbackCopy();
        }

        function fallbackCopy() {
          try {
            const textArea = document.createElement('textarea');
            textArea.value = PHONE_NUMBER;
            textArea.style.cssText = 'position:fixed;left:-9999px;top:-9999px;opacity:0;';
            textArea.setAttribute('readonly', '');
            textArea.setAttribute('aria-hidden', 'true');
            document.body.appendChild(textArea);
            textArea.select();
            textArea.setSelectionRange(0, PHONE_NUMBER.length);

            const success = document.execCommand('copy');
            document.body.removeChild(textArea);
            showFeedback(success);

            if (!success) console.error('[Clipboard] execCommand falló');
          } catch (err) {
            console.error('[Clipboard] Error en fallback:', err);
            showFeedback(false);
          }
        }
      }

      function openModal() {
        lastFocusedElement = document.activeElement;
        modal.style.display = 'flex';
        requestAnimationFrame(function () {
          modal.classList.add('show');
        });

        setTimeout(function () {
          closeModalBtn.focus();
        }, 100);

        const btnInfo = document.getElementById('btn-info-custom');
        if (btnInfo) {
          btnInfo.classList.add('info-active');
          btnInfo.setAttribute('aria-expanded', 'true');
        }

        document.body.style.overflow = 'hidden';
      }

      function closeModal() {
        modal.classList.remove('show');

        setTimeout(function () {
          modal.style.display = 'none';
        }, 300);

        const btnInfo = document.getElementById('btn-info-custom');
        if (btnInfo) {
          btnInfo.classList.remove('info-active');
          btnInfo.setAttribute('aria-expanded', 'false');
          btnInfo.blur();
        }

        document.body.style.overflow = '';
        lastFocusedElement = null;
      }

      function toggleInfo() {
        if (modal.classList.contains('show')) closeModal();
        else openModal();
      }

      window.toggleInfo = toggleInfo;

      // --- dFlip ---
      function buildLangControls($controls) {
        if (document.getElementById('df-ui-langgroup')) return;

        const t = I18N[currentLang] || I18N.es;

        const $group = $('<div>', {
          id: 'df-ui-langgroup',
          class: 'df-ui-langgroup',
          role: 'group',
          'aria-label': t.langGroupAria
        });

        const $btnES = $('<button>', {
          id: 'btn-lang-es',
          type: 'button',
          class: 'df-ui-btn df-ui-langbtn',
          title: t.langESTitle,
          'aria-label': t.langESTitle,
          'aria-pressed': String(currentLang === 'es')
        }).text(t.langES);

        const $sep = $('<span>', {
          class: 'df-ui-langsep',
          'aria-hidden': 'true'
        }).text('/');

        const $btnEN = $('<button>', {
          id: 'btn-lang-en',
          type: 'button',
          class: 'df-ui-btn df-ui-langbtn',
          title: t.langENTitle,
          'aria-label': t.langENTitle,
          'aria-pressed': String(currentLang === 'en')
        }).text(t.langEN);

        function onToggle(targetLang) {
          if (targetLang === currentLang) return;
          setLanguage(targetLang);
        }

        $btnES.on('click', function () {
          onToggle('es');
        });
        $btnEN.on('click', function () {
          onToggle('en');
        });

        $btnES.on('keydown', function (e) {
          if (e.key === 'Enter' || e.key === ' ' || e.keyCode === 13 || e.keyCode === 32) {
            e.preventDefault();
            onToggle('es');
          }
        });
        $btnEN.on('keydown', function (e) {
          if (e.key === 'Enter' || e.key === ' ' || e.keyCode === 13 || e.keyCode === 32) {
            e.preventDefault();
            onToggle('en');
          }
        });

        $group.append($btnES, $sep, $btnEN);
        $controls.append($group);

        updateLangButtonState();
      }

      function updateLangButtonState() {
        const btnES = document.getElementById('btn-lang-es');
        const btnEN = document.getElementById('btn-lang-en');
        if (btnES) {
          btnES.classList.toggle('lang-active', currentLang === 'es');
          btnES.setAttribute('aria-pressed', String(currentLang === 'es'));
        }
        if (btnEN) {
          btnEN.classList.toggle('lang-active', currentLang === 'en');
          btnEN.setAttribute('aria-pressed', String(currentLang === 'en'));
        }
      }

      function initFlipbook() {
        hidePdfError();

        const t = I18N[currentLang] || I18N.es;
        const pdfName = getPdfForLang(currentLang);

        const bookOptions = {
          source: pdfName,
          webgl: true,
          height: '100%',
          duration: 700,
          backgroundColor: 'transparent',
          disableFolderPath: true,

          text: t.dflipText,

          allControls: 'altPrev,pageNumber,altNext,play,outline,thumbnail,zoomIn,zoomOut,fullScreen',
          hideControls: 'share,download,more',

          onReady: function () {
            const existingInfoBtn = document.getElementById('btn-info-custom');
            if (!existingInfoBtn) {
              const infoBtn = $('<button>', {
                class: 'df-ui-btn df-ui-info',
                id: 'btn-info-custom',
                type: 'button',
                title: t.infoBtnTitle,
                'aria-label': t.infoBtnAria,
                'aria-expanded': 'false',
                'aria-haspopup': 'dialog'
              }).html('<i class="ti-info-alt" aria-hidden="true"></i>');

              infoBtn.on('click', function () {
                toggleInfo();
              });

              infoBtn.on('keydown', function (e) {
                if (e.key === 'Enter' || e.key === ' ' || e.keyCode === 13 || e.keyCode === 32) {
                  e.preventDefault();
                  toggleInfo();
                }
              });

              let $controls = $('.df-ui-wrapper')
                .filter(function () {
                  return (
                    $(this).find('.df-ui-next, .df-ui-altNext, .df-ui-btn.df-ui-next, .df-ui-btn.df-ui-altNext')
                      .length > 0
                  );
                })
                .first();

              if ($controls.length === 0) {
                $controls = $('.df-ui-wrapper').last();
              }

              if ($controls.length > 0) {
                $controls.append(infoBtn);
              }
            } else {
              applyI18n(currentLang);
            }

            let $controlsLang = $('.df-ui-wrapper')
              .filter(function () {
                return (
                  $(this).find('.df-ui-next, .df-ui-altNext, .df-ui-btn.df-ui-next, .df-ui-btn.df-ui-altNext')
                    .length > 0
                );
              })
              .first();

            if ($controlsLang.length === 0) {
              $controlsLang = $('.df-ui-wrapper').last();
            }

            if ($controlsLang.length > 0) {
              buildLangControls($controlsLang);
            }

            $('.df-ui-btn').each(function () {
              const $btn = $(this);
              const title = $btn.attr('title') || '';
              if (!$btn.attr('aria-label') && title) $btn.attr('aria-label', title);
              if (!$btn.attr('role')) $btn.attr('role', 'button');
            });

            updateLangButtonState();
          },

          onError: function (error) {
            console.error('[dFlip] Error al cargar el PDF:', error);
            showPdfError();
          }
        };

        try {
          const container = document.getElementById('flipbook-container');
          if (container) container.innerHTML = '';

          const book = $('#flipbook-container').flipBook(bookOptions.source, bookOptions);
          if (!book) {
            console.error('[dFlip] No se pudo inicializar el libro');
            showPdfError();
          }
        } catch (e) {
          console.error('[dFlip] Excepción al inicializar:', e);
          showPdfError();
        }
      }

      function setLanguage(lang) {
        if (lang !== 'es' && lang !== 'en') lang = 'es';
        currentLang = lang;

        try {
          localStorage.setItem(STORAGE_KEY_LANG, currentLang);
        } catch (_) {}

        setLangInUrl(currentLang);
        applyI18n(currentLang);
        updateLangButtonState();

        initFlipbook();
      }

      // --- LISTENERS ---
      closeModalBtn.addEventListener('click', closeModal);
      phoneBtn.addEventListener('click', copyPhone);

      modal.addEventListener('click', function (e) {
        if (e.target === modal) closeModal();
      });

      document.addEventListener('keydown', function (e) {
        if (!modal.classList.contains('show')) return;

        if (e.key === 'Escape' || e.keyCode === 27) {
          e.preventDefault();
          closeModal();
          return;
        }

        if (e.key === 'Tab' || e.keyCode === 9) {
          const focusableElements = modal.querySelectorAll(
            'button, a[href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
          );
          const firstEl = focusableElements[0];
          const lastEl = focusableElements[focusableElements.length - 1];

          if (e.shiftKey) {
            if (document.activeElement === firstEl) {
              e.preventDefault();
              lastEl.focus();
            }
          } else {
            if (document.activeElement === lastEl) {
              e.preventDefault();
              firstEl.focus();
            }
          }
        }
      });

      // --- INIT ---
      initGrained();

      (function initLanguage() {
        const fromUrl = getLangFromUrl();
        if (fromUrl) {
          currentLang = fromUrl;
        } else {
          try {
            const saved = (localStorage.getItem(STORAGE_KEY_LANG) || '').toLowerCase();
            if (saved === 'es' || saved === 'en') currentLang = saved;
          } catch (_) {}
          setLangInUrl(currentLang);
        }

        applyI18n(currentLang);
      })();

      jQuery(document).ready(function () {
        initFlipbook();
      });
    })();
  </script>
</body>
</html>
